import{f as B,c as f,a as u,F as D,r as V,o as v,s as X,t as x,_ as M,j as I,x as Y,y as K,i as $,z as Z,B as ee,C as te,D as F,E as U,G,H as ne,I as q,k as H,m as ie,l as j,v as ae,u as h,J as oe,b as O,w as le,d as N,A as E,p as P,h as re,K as L}from"./DHe4-ZUZ.js";import{_ as se}from"./BZ0OGUnk.js";import{a as ce}from"./MNsQ0NJ5.js";const de={class:"aside"},ue={class:"aside__lists"},ve=["onClick"],me=B({__name:"TheAside",props:{menus:{},switchBlock:{type:Function},block:{}},setup(e){return(n,t)=>(v(),f("div",de,[t[0]||(t[0]=u("h6",{class:"title-block"}," MENU ",-1)),u("ul",ue,[(v(!0),f(D,null,V(Object.values(e.menus),a=>(v(),f("li",{key:a.value},[u("div",{class:X([e.block===a.value&&"aside__active"]),onClick:i=>e.switchBlock(a.value)},x(a.text),11,ve)]))),128))])]))}}),fe=M(me,[["__scopeId","data-v-949cd693"]]);var _e=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],ge=function(e){return _e.map(function(n){return n.toLowerCase()}).indexOf(e.toLowerCase())!==-1},ye=function(e,n,t){Object.keys(n).filter(ge).forEach(function(a){var i=n[a];typeof i=="function"&&(a==="onInit"?i(e,t):t.on(a.substring(2),function(r){return i(r,t)}))})},pe=function(e,n,t,a){var i=e.modelEvents?e.modelEvents:null,r=Array.isArray(i)?i.join(" "):i;I(a,function(o,s){t&&typeof o=="string"&&o!==s&&o!==t.getContent({format:e.outputFormat})&&t.setContent(o)}),t.on(r||"change input undo redo",function(){n.emit("update:modelValue",t.getContent({format:e.outputFormat}))})},he=function(e,n,t,a,i,r){a.setContent(r()),t.attrs["onUpdate:modelValue"]&&pe(n,t,a,i),ye(e,t.attrs,a)},R=0,J=function(e){var n=Date.now(),t=Math.floor(Math.random()*1e9);return R++,e+"_"+t+R+String(n)},be=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},T=function(e){return typeof e>"u"||e===""?[]:Array.isArray(e)?e:e.split(" ")},Ce=function(e,n){return T(e).concat(T(n))},Ae=function(e){return e==null},z=function(){return{listeners:[],scriptId:J("tiny-script"),scriptLoaded:!1}},ke=function(){var e=z(),n=function(i,r,o,s){var l=r.createElement("script");l.referrerPolicy="origin",l.type="application/javascript",l.id=i,l.src=o;var b=function(){l.removeEventListener("load",b),s()};l.addEventListener("load",b),r.head&&r.head.appendChild(l)},t=function(i,r,o){e.scriptLoaded?o():(e.listeners.push(o),i.getElementById(e.scriptId)||n(e.scriptId,i,r,function(){e.listeners.forEach(function(s){return s()}),e.scriptLoaded=!0}))},a=function(){e=z()};return{load:t,reinitialize:a}},Se=ke(),De=function(){return typeof window<"u"?window:global},k=function(){var e=De();return e&&e.tinymce?e.tinymce:null},we={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},S=function(){return S=Object.assign||function(e){for(var n,t=1,a=arguments.length;t<a;t++){n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},S.apply(this,arguments)},xe=function(e,n,t,a){return e(a||"div",{id:n,ref:t})},Ee=function(e,n,t){return e("textarea",{id:n,visibility:"hidden",ref:t})},Pe=B({props:we,setup:function(e,n){var t=e.init?S({},e.init):{},a=Y(e),i=a.disabled,r=a.modelValue,o=a.tagName,s=K(null),l=null,b=e.id||J("tiny-vue"),A=e.init&&e.init.inline||e.inline,c=!!n.attrs["onUpdate:modelValue"],y=!0,d=e.initialValue?e.initialValue:"",p="",m=function(_){return c?function(){return r?.value?r.value:""}:function(){return _?d:p}},C=function(){var _=m(y),g=S(S({},t),{readonly:e.disabled,selector:"#"+b,plugins:Ce(t.plugins,e.plugins),toolbar:e.toolbar||t.toolbar,inline:A,setup:function(w){l=w,w.on("init",function(Q){return he(Q,e,n,w,r,_)}),typeof t.setup=="function"&&t.setup(w)}});be(s.value)&&(s.value.style.visibility=""),k().init(g),y=!1};I(i,function(_){var g;l!==null&&(typeof((g=l.mode)===null||g===void 0?void 0:g.set)=="function"?l.mode.set(_?"readonly":"design"):l.setMode(_?"readonly":"design"))}),I(o,function(_){var g;c||(p=l.getContent()),(g=k())===null||g===void 0||g.remove(l),U(function(){return C()})}),$(function(){if(k()!==null)C();else if(s.value&&s.value.ownerDocument){var _=e.cloudChannel?e.cloudChannel:"5",g=e.apiKey?e.apiKey:"no-api-key",w=Ae(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+g+"/tinymce/"+_+"/tinymce.min.js":e.tinymceScriptSrc;Se.load(s.value.ownerDocument,w,C)}}),Z(function(){k()!==null&&k().remove(l)}),A||(ee(function(){y||C()}),te(function(){var _;c||(p=l.getContent()),(_=k())===null||_===void 0||_.remove(l)}));var W=function(_){var g;p=l.getContent(),(g=k())===null||g===void 0||g.remove(l),t=S(S({},t),_),U(function(){return C()})};return n.expose({rerender:W}),function(){return A?xe(F,b,s,e.tagName):Ee(F,b,s)}}});const Ve={class:"admin-article"},Be=["label"],Ie=["value"],Me={class:"admin-article__text"},Oe=["required"],$e={type:"submit",class:"btn btn--yellow btn--big"},Fe=B({__name:"AdminArticle",props:{updatePostData:{type:Function},category:{},edit:{}},setup(e){const n=e,t=G(),a=ne(),{vueAppTinymceKey:i}=a.public,r=q(()=>t.categories),o=K({_id:"",title:"",category:"css",image:null,text:""}),s={height:500,images_upload_handler:(y,d)=>{const p=new FormData;p.append("file",y.blob(),y.filename()),E.uploadImage(p).then(m=>d(m.link)).catch(m=>console.error(P(m)))},codesample_global_prismjs:!0,relative_urls:!1,menubar:!0,plugins:["advlist autolink lists link image","code","media table code codesample"],toolbar:"undo redo | formatselect | bold italic backcolor |     alignleft aligncenter alignright alignjustify |     bullist numlist outdent indent | removeformat | codesample"},l=()=>{o.value={_id:"",title:"",category:"css",image:null,text:""}},b=y=>{const d=y.target;o.value.image=d.files?d.files[0]:null},A=()=>{n.updatePostData(),l()},c=async()=>{if(!o.value.text){alert("Fill all fields!");return}const y=n.edit?._id,d={...o.value};try{y?(await E.updatePost(d),alert("Article updated!")):(await E.createPost(d),alert("Article added!")),n.updatePostData(),l()}catch(p){console.error(P(p))}};return $(()=>{n.edit?._id&&(o.value={_id:n.edit._id,title:n.edit.title,category:n.edit.category,image:null,text:n.edit.text})}),(y,d)=>{const p=se;return v(),f("div",Ve,[u("form",{onSubmit:ie(c,["prevent"])},[j(u("input",{"onUpdate:modelValue":d[0]||(d[0]=m=>h(o).title=m),required:"",placeholder:"Title",class:"input admin-article__title"},null,512),[[ae,h(o).title,void 0,{lazy:!0,trim:!0}]]),j(u("select",{"onUpdate:modelValue":d[1]||(d[1]=m=>h(o).category=m),name:"category",required:"",class:"select admin-article__select"},[(v(!0),f(D,null,V(h(r),m=>(v(),f("optgroup",{key:m.title,label:m.title},[(v(!0),f(D,null,V(m.subCategories,C=>(v(),f("option",{key:C.name,value:C.name},x(C.name),9,Ie))),128))],8,Be))),128))],512),[[oe,h(o).category]]),u("div",Me,[O(p,null,{default:le(()=>[O(h(Pe),{modelValue:h(o).text,"onUpdate:modelValue":d[2]||(d[2]=m=>h(o).text=m),"api-key":h(i),init:s},null,8,["modelValue","api-key"])]),_:1})]),u("input",{required:!h(o)?._id,accept:"image/*",class:"admin-article__preview",type:"file",onChange:d[3]||(d[3]=m=>b(m))},null,40,Oe),u("button",$e,[h(o)?._id?(v(),f(D,{key:0},[N(" UPDATE ")],64)):(v(),f(D,{key:1},[N(" ADD ")],64))])],32),h(o)?._id?(v(),f("button",{key:0,class:"btn btn--red btn--big mt--20",onClick:A}," CANCEL ")):H("",!0)])}}}),Ue=M(Fe,[["__scopeId","data-v-4278b681"]]),je={class:"all-articles"},Ne={class:"all-articles__lists-header"},Le={class:"all-articles__lists"},Re={class:"all-articles__list-title"},Te={class:"all-articles__list-date"},ze={class:"all-articles__list-category"},Ke=["onClick"],Ge=["onClick"],qe=B({__name:"AdminArticles",props:{editArticle:{type:Function},deleteArticle:{type:Function},lists:{}},setup(e){const n=["Name","Date","Categories","Update","Delete"];return(t,a)=>(v(),f("div",je,[u("div",Ne,[(v(),f(D,null,V(n,i=>u("div",{key:i,class:"all-articles__list-header"},x(i),1)),64))]),u("div",Le,[(v(!0),f(D,null,V(e.lists,i=>(v(),f("div",{key:i._id,class:"all-articles__list"},[u("div",Re,x(i.title),1),u("div",Te,x(i.date),1),u("div",ze,x(i.category),1),u("button",{class:"all-articles__list-nav all-articles__list-nav-edit",onClick:r=>e.editArticle(i)}," Update ",8,Ke),u("button",{class:"all-articles__list-nav all-articles__list-nav-del",onClick:r=>e.deleteArticle(i._id,i.title)}," Delete ",8,Ge)]))),128))])]))}}),He=M(qe,[["__scopeId","data-v-8f60e301"]]),Je={class:"admin-panel"},We=B({__name:"admin-panel",setup(e){const n=G(),t=re({isAdmin:!1,block:"article",edit:{author:"",category:"",date:"",image:"",text:"",title:"",_id:""},allArticles:[]}),a={article:{text:"Add article",value:"article"},articles:{text:"All articles",value:"articles"}},i=q(()=>n.categories),r=c=>{t.block!==c&&(t.block=c)},o=c=>{t.block="article",t.edit={...c}},s=()=>{E.getPosts().then(c=>{t.allArticles=c.data}).catch(c=>{console.error(P(c))})},l=async(c,y)=>{confirm(`Are you sure you want to delete this post: "${y}"`)&&(await E.deletePost(c).catch(p=>console.error(P(p))),s())},b=()=>{t.edit={author:"",category:"",date:"",image:"",text:"",title:"",_id:""},s()};$(()=>{E.checkAccess().then(()=>t.isAdmin=!0).catch(c=>console.error(P(c))),s()}),I(()=>t.block,()=>{t.block===a.articles.value&&t.edit._id&&b()});const A={title:"Admin Panel",description:"Admin Panel"};return ce({title:A.title,description:A.description,robots:"noindex, nofollow",ogImage:"/media/meta/meta.png"}),(c,y)=>(v(),f("div",Je,[O(fe,{menus:a,"switch-block":r,block:t.block},null,8,["block"]),u("div",null,[t.block==="article"?(v(),L(Ue,{key:0,edit:t.edit,category:i.value,"update-post-data":b,"get-posts":s},null,8,["edit","category"])):t.block==="articles"?(v(),L(He,{key:1,"edit-article":o,"delete-article":l,lists:t.allArticles},null,8,["lists"])):H("",!0)])]))}}),Ze=M(We,[["__scopeId","data-v-374a4419"]]);export{Ze as default};
